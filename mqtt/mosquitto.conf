# Mosquitto MQTT Broker 配置文件

# 监听端口
listener 1883
protocol mqtt

# WebSocket 监听端口
listener 9001
protocol websockets

# 允许匿名连接（生产环境建议关闭）
allow_anonymous true

# 持久化设置
persistence true
persistence_location /mosquitto/data/

# 日志设置
log_dest file /mosquitto/log/mosquitto.log
log_type all
log_timestamp true

# 连接设置
max_connections -1
max_inflight_messages 20
max_queued_messages 5000  # 增加队列大小，支持更多离线消息
max_queued_bytes 100MB    # 限制队列总大小

# 消息大小限制 (10MB)
message_size_limit 10485760

# 自动保存间隔（秒）
autosave_interval 60

# 保留消息设置
retained_persistence true

